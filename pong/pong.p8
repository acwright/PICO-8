pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
--pong
--by aaron wright

function _init()
	state=1
end

function _update60()
	if state==1 then
		update_start()
	elseif state==2 then
		update_controls()
		if delay==0 then
			update_ball()
			update_ai()
		else
			delay=delay-1
		end
	elseif state==3 then
		update_gameover()
	end
end

function _draw()
	cls()
	if state==1 then
		print("pong",56,32,7)
		print("by ac wright",40,40,6)
		print("--2019--",48,56,5)
		print("press ‚ùé or üÖæÔ∏è",36,98,7)
	elseif state==2 then
		map(0)
		draw_ball()
		draw_player()
		draw_computer()
		draw_score()
	elseif state==3 then
		if score.player>score.computer then
			print("you win!",46,40,6)
		else
			print("game over!",45,40,6)
		end
		print("press ‚ùé or üÖæÔ∏è",36,98,7)
	end
end

function reset()
	delay=60
	serve=new_serve()
	ball=new_ball()
	player=new_player()
	computer=new_computer()
	score=new_score()
end

function update_ball()
	ball.x=ball.x+ball.vx
	ball.y=ball.y+ball.vy
	
	if ball.x<0 then
		delay=60
		serve=-1
		ball=new_ball()
		score.computer=score.computer+1
		sfx(2)
		if score.computer>=11 then
			state=3
		end
	end
	if ball.x>128 then
		delay=60
		serve=1
		ball=new_ball()
		score.player=score.player+1
		sfx(1)
		if score.player>=11 then
			state=3
		end
	end
	if ball.y>123 or ball.y<2 then
		ball.vy=ball.vy*-1
		sfx(0)
	end
	if is_player_colliding() then
		player_collide()
	elseif is_computer_colliding() then
		computer_collide()
	end
end

function update_controls()
	if btn(2) then
		move_up()
	end
	if btn(3) then
		move_down()
	end
end

function update_start()
	if btnp(4) or btnp(5) then
		reset()
		state=2
	end
end

function update_gameover()
	if btnp(4) or btnp(5) then
		state=1
	end
end

function update_ai()
	if ball.y<computer.y and computer.y>0 then
		computer.y=computer.y-1
	elseif ball.y>computer.y and computer.y<120 then
		computer.y=computer.y+1
	end
end
-->8
--inits

function new_serve()
	return -1
end

function new_ball()
	local y=flr(rnd(120))+4
	local vy=1
	if y>64 then
		vy=-1
	end
	local x=64
	if serve==1 then
		x=56
	end
	return {
		x=x,
		y=y,
		vx=serve,
		vy=vy
	}
end

function new_player()
	return {
		x=0,
		y=64
	}
end

function new_computer()
	return {
		x=120,
		y=64
	}
end

function new_score()
	return {
		player=0,
		computer=0
	}
end
-->8
--drawing

function draw_ball()
	spr(1,ball.x,ball.y)
end

function draw_player()
	spr(2,player.x,player.y)
end

function draw_computer()
	spr(2,computer.x,computer.y)
end

function draw_score()
	if score.player<10 then
		print("0"..score.player,50,0)
	else
		print(score.player,50,0)
	end
	if score.computer<10 then
		print("0"..score.computer,71,0)
	else
		print(score.computer,72,0)
	end
end
-->8
--movement

function move_up()
	if player.y>0 then
		player.y=player.y-2
	end
end

function move_down()
	if player.y+8<128 then
		player.y=player.y+2
	end
end
-->8
--helpers

function is_player_colliding()
	if ball.x+3==player.x+5 and
				player.y>=ball.y-5 and
				player.y<=ball.y+5 then
		return true
	end
	return false
end

function is_computer_colliding()
	if ball.x+5==computer.x+3 and
				computer.y>=ball.y-5 and
				computer.y<=ball.y+5 then
		return true
	end	
	return false
end

function player_collide()
	ball.vx=ball.vx*-1
	sfx(0)
	if ball.y==player.y then
		ball.vy=0
	elseif abs(ball.y-player.y)>=1 and abs(ball.y-player.y)<3 then
		if ball.vy>0 then
			ball.vy=1
		else
			ball.vy=-1
		end
	elseif abs(ball.y-player.y)>=3 and abs(ball.y-player.y)<5 then
		if ball.vy>0 then
			ball.vy=2
		else
			ball.vy=-2
		end
	end
end

function computer_collide()
	ball.vx=ball.vx*-1
	sfx(0)
	if ball.y==computer.y then
		ball.vy=0
	elseif abs(ball.y-computer.y)>=1 and abs(ball.y-player.y)<3 then
		if ball.vy>0 then
			ball.vy=1
		else
			ball.vy=-1
		end
	elseif abs(ball.y-computer.y)>=3 and abs(ball.y-player.y)<5 then
		if ball.vy>0 then
			ball.vy=2
		else
			ball.vy=-2
		end
	end
end
__gfx__
00000000000000000007700060000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000007700060000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000770000007700060000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000770000007700060000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000007700060000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000007700060000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000666066600000066000000666066600000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000606000600000000000000606000600000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000606006600000066000000606006600000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000606000600000066000000606000600000000000000000000000000000000000000000000077000
00000000000000000000000000000000000000000000000000666066600000066000000666066600000000000000000000000000000000000000000000077000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000077000
00000000000000000000000000000000000000000000000000000000077000066000000000000000000000000000000000000000000000000000000000077000
00000000000000000000000000000000000000000000000000000000077000066000000000000000000000000000000000000000000000000000000000077000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000077000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000077000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000077000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000000

__map__
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000004030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000500001405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000004050090500d0501105014050160500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000600000e0500e0500d0500a05007050040500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
